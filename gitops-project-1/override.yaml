## Harness GitOps Agent - Overrides File
## For default overrides, please refer to https://github.com/harness/gitops-helm/blob/main/values.yaml
## Argo CD overrides can be found at https://github.com/argoproj/argo-helm/blob/main/charts/argo-cd/values.yaml

# <---Argo CD image details--->
global:
  image:
    repository: docker.io/harness/argocd
    tag: v2.14.21

# <---Harness configuration overrides--->
harness:
  identity:
    accountIdentifier: vpCkHKsDSxK9_KYfjCTMKA
    orgIdentifier: default
    projectIdentifier: akshitdevrelharness
    agentIdentifier: gitopsagent001

  secrets:
    agentSecret: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFdmdJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLZ3dnZ1NrQWdFQUFvSUJBUURKbmVQL2djdm05c1NuCk9ueVBaaVBOMDUzTEEwSHlqSDJuNmpCVmtDcUNhLzl3aHdBMFJUTG1LN0hMR0k1eklIN3hrTUYvYnBrK3R0aTMKdW9zN08zYXdBNTJGYnZRbUtRUUR4c0krbEl4R0h3bm01aGRMcUlySENPNUpBYlBvWUowOThkRGExeEd1YitKSAp6UDkvYXk4amZUVkM5OXpKTzR5RzZjbjFVNVczQzVQbzQ3UlRnS21QSUFJczR2SlFVMG05K28rSWN4RjlBWDlOCkx0UngvaE9CNzFIV2FlSlJRKzFGcERkU0pPcTJOYUFoTVgyMWU2T05mTnorV3RzNUdLY1JKQ2IzMEp2bzNjaW0KQXVHKzg1Q1ZISHV3eDBzU0djZ0pYVjB2NEx0bFZXa3JiM0dSL1V0UkREdU1Fc2M3YzFJb093ZFIzZkVHWU94bAp6dDdBTm1NUEFnTUJBQUVDZ2dFQVI1R2t2YTUxa3lkRjU1YjdZR3dCaWE3MDlIdlRqU1lSOU9sTS94S09CSDRSCnp3QWRNbkRlQUpiQ0pqWXhXdXpPSXpJZmZmemtxVDUrNzdsb2N6NUlnM0xGRi9pcThtRGM2L3BDT2JUQmxxS3UKQVNqc1hBOFlORThYUnhNenFlbWg1N3RQU0YvUUJ2dndkMHh0NWUxR2JuS2oxWUhtL2dnRmVsN0RNakxaa29BSQpOT0RPOU04eWtSSDhYMS9rRW1FQ1JOVC9CbFkxSEZTdXVRcmNwSlJCczhxNFJCWkpsOEtoZG1RaXRIRndTbW9tCi9RblNoMUw1SzJzMWZWdFhyUFRkNFpSek5XTi9PZDUrZWxjenVhdzRIOFIxSWFNU1lpeVpjQkk0K2pMZUR3MngKOE14Q0gxUUlZZkRKb2JOd3hlSS85T3JQZUpCcDhHcXNZSnA0UndMaEFRS0JnUURhUXdoTWkvUEpRWHlTUGsyMwpxRWkwVjZMMzFBeUY4VDd6cElTTVFVNFRnMFZUM00vMFZibUlwMUNPTjIvTk51azZ3M05RNHlYQ0RqYWFhbWtwCktOSUhXSjhzczBRaGhrK3g1L3BXaldNUnk4amVHY0duRG1UQXMrVTNLWGpBbjdFWk4wczlHbUtLRFFuM3lFMWoKdm5UV3h2S2RaYVdXNERUWFNnZWk1Y1NvS3dLQmdRRHNlaGZ1RGxsaVBLK2RLbnlLdmRGUG5RVE1rMnNzUkN0YgorRkZPVzlCVHRyRkJFYnorQnF5ZjJuclN2TkdWK05oYVh2ZG12QmN5SnpGNWFvODRJbkxmajlLUjdheWx1ZWlyCnhlVFMxOFY0cXhTMHczbjU0SUZRUXdlNEJleDNaOWhxdTNmTjNva1FRT294UUJzYkJjT2NrOThUOXlNeVdWdE4Kclh4TzJpVTZyUUtCZ1FERnQ0T0ZGQ0s3WmI5YkcyVjd3YzVhMENpcEtFWlA3OEovSThHTzdIbTE0MnlpRTUydQpVUm5KV1FmNFRPL1Nqck9vci9WK2lNWmpqRXlhaFZyT0ZsUnNvek5PWXZhTkNBYVp1dk5rQktDQ05vQzM4YzBqCmNENkU4bkhxRG45OHZ5ekhFdmZ0V2tGNW5XWXlPQmtqQ2h6OWt5dWt1YmZQZlR0ZzY0Y1BZZVZNRVFLQmdEcmEKM0UvVVpHeXR1K3Q2NG9wSldlbmRvNDhpOVo2THpOclQvN0JuNjM2YVRwMXFROFpaZE9kSUloK0cvUWE5YTJONgpsVXFOYjV4ODRyUmNVQTdoakFPV01Rcyt3eVJ3RTdlRXhrR3ZrQ2RMTlJrVU9heDJNdGorQmRMSUxxVTlSRUMwCkxjb2dJNjdXNlRLZXlPQTkzQVNCVFJrVC9qK091OG1tYnZUVkdFVDFBb0dCQUpEdHNWaXdEajErZHNIUnYxZ2wKMmszNlpuMXhWYjhzUjhKc1Y5dVQyTVdpSGFrbERrSy9jS1dEbVBvNStoZnV2bjE0WGFvdkZXUEloOVNSSUpObQpOYW9CeTBEV2duM1YzQlhXNk9Nc2lWSDc3L0J2Y0QwSFc2V2FyL0svakNvQ0FIdk1YUzBGa0tLK2ZLdGtpT0JXCjg3M3hCMXpLTTVRdjliZjhuOVZycy84TwotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
    # <---CA data overrides--->
    caData:
      enabled: false
      secret: 
    redisPassword: QIuH_7O6gL1Ctg==

  gitopsServerHost: https://app.harness.io/gratis/gitops
  networkPolicy:
    create: true
  createClusterRoles: true

  configMap:
    logLevel: debug

    # <---Agent communication protocol details--->
    http:
      agentHttpTarget: https://app.harness.io/gitops
      tlsEnabled: false
      certPath: /tmp/ca.bundle

  # <---Disaster Recovery override values--->
  disasterRecovery:
    enabled: false
    identifier: 

  # <---Openshift override values--->
  openshift:
    enabled: false
  flux:
    enabled: false
  argocdHarnessPlugin:
    enabled: false

argo-cd:
  enabled: true

# <---Argo CD configuration overrides--->

  ## IMPORTANT: Mark crds as false for Helm installations if they are already installed in the cluster
  crds:
    install: true
    keep: true

  configs:
    cm:
      cluster.inClusterEnabled: true

  # <---Redis image details--->
  redis:
    enabled: true
    image:
      repository: docker.io/harness/redis
      tag: 7.4.7-alpine

  redisSecretInit:
    enabled: true

  # <---High Availability Agent (HA) values--->
  redis-ha:
    enabled: false
    image:
      repository: docker.io/harness/redis
      tag: 7.4.7-alpine
    haproxy:
      enabled: false
      image:
        repository: docker.io/haproxy
        tag: lts-alpine3.22
    configmapTest:
      ## Image for redis-ha-configmap-test hook
      image:
        repository: docker.io/koalaman/shellcheck
        tag: v0.5.0

  repoServer:
    replicas:  1 
    env:
      - name: HELM_PLUGINS
        value: /helm-sops-tools/helm-plugins/
      - name: HELM_SECRETS_CURL_PATH
        value: /helm-sops-tools/curl
      - name: HELM_SECRETS_SOPS_PATH
        value: /helm-sops-tools/sops
      - name: HELM_SECRETS_KUBECTL_PATH
        value: /helm-sops-tools/kubectl
      - name: HELM_SECRETS_BACKEND
        value: sops
      - name: HELM_SECRETS_VALUES_ALLOW_SYMLINKS
        value: "false"
      - name: HELM_SECRETS_VALUES_ALLOW_ABSOLUTE_PATH
        value: "true"
      - name: HELM_SECRETS_VALUES_ALLOW_PATH_TRAVERSAL
        value: "false"
      - name: HELM_SECRETS_WRAPPER_ENABLED
        value: "true"
      - name: HELM_SECRETS_HELM_PATH
        value: /usr/local/bin/helm
    

    # <---SOPS override values--->
    initContainers:
      - name: sops-helm-secrets-tool
        image: docker.io/harness/gitops-agent-installer-helper:v0.0.7
        imagePullPolicy: IfNotPresent
        command: [ sh, -ec ]
        args:
          - |
            cp -r /custom-tools/. /helm-sops-tools
            cp /helm-sops-tools/helm-plugins/helm-secrets/scripts/wrapper/helm.sh /helm-sops-tools/helm
            chmod +x /helm-sops-tools/*
        volumeMounts:
          - mountPath: /helm-sops-tools
            name: helm-sops-tools
    extraContainers:
      - command: [ /var/run/argocd/argocd-cmp-server ]
        image: docker.io/harness/gitops-agent-installer-helper:v0.0.7
        imagePullPolicy: IfNotPresent
        name: argocd-harness-plugin
        securityContext:
          capabilities:
            drop:
              - NET_RAW
          runAsGroup: 999
          runAsUser: 999
        terminationMessagePath: /dev/termination-log
        terminationMessagePolicy: File
        volumeMounts:
          - mountPath: /var/run/argocd
            name: var-files
          - mountPath: /home/argocd/cmp-server/plugins
            name: plugins
          - mountPath: /tmp
            name: tmp
          - mountPath: /home/argocd/cmp-server/config/plugin.yaml
            name: argocd-harness-plugin
            subPath: harness.yaml

# <---Agent overrides--->
agent:
  harnessName: gitops-agent-001
  image:
    repository: docker.io/harness/gitops-agent
    tag: v0.104.0

  replicas: 1

  fipsEnabled: false

  autoscaling:
    enabled: false

  highAvailability: false
  # <---Agent Proxy Config overrides--->
  proxy:
    enabled: false
    httpProxy: 
    httpsProxy: 

# <---Agent upgrader overrides--->
upgrader:
  enabled: true
  image: docker.io/harness/upgrader:latest